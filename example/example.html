<html>
	<head>
		<title>test</title>
	</head>
	<body>
		<div id='main_container'>
			<a id='login'>login</a>
		</div>
		<script type="text/javascript" src='../lib/jquery-1.7.2.js'></script>
		<script type="text/javascript" src='../lib/underscore.js'></script>
		<script type="text/javascript" src='../ivle.js'></script>
		<script type="text/javascript">
		$(function(){
			var apikey = "ba1ge5NQ9cl76KQNI1Suc";
			var myapp = new ivle(apikey);
			
			// //FOR DEMO PURPOSES ONLY.
			var re = new RegExp('token=(.+)');
			var token = re.exec(window.location.href);
			if (!token){
				myapp.auth($('#login'), window.location.origin + window.location.pathname + "#");
				window.location.href = window.location.origin + window.location.pathname + "#welcome";
			} else {
				$('#login').remove();
				var authtoken = token[1];
				window.location.href = window.location.origin + window.location.pathname + "#loggedin";
				
				user = new myapp.user(authtoken);
				user.modules(function(data){
					$("<h3>").text("Your Modules:").appendTo($('#main_container'));
					_.each(data.Results, function(module){
						$("<p>").text(module.CourseName).appendTo($('#main_container'));
					});
				}, function(){
					console.log(arguments);
				});
			}
			// var user = new myapp.user(authtoken);
			// user.modules(function(data){
			// 	console.log(data);
			// });

			// user.workbin("7d54f5c5-e147-4f3d-9b7f-931fcca9060d", function(data){
			// 	console.log(data);
			// });

			// user.file("c3d0b52a-da36-4044-9e10-324e5e2174fe", function(data){
			// 	console.log(data);
			// });
		});
			
		</script>
	</body>
</html>